/*!
 * Tenuki v0.2.2 (https://github.com/aprescott/tenuki)
 * Copyright Â© 2016 Adam Prescott.
 * Licensed under the MIT license.
 */
(function(t){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=t()}else if(typeof define==="function"&&define.amd){define([],t)}else{var e;if(typeof window!=="undefined"){e=window}else if(typeof global!=="undefined"){e=global}else if(typeof self!=="undefined"){e=self}else{e=this}e.tenuki=t()}})(function(){var t,e,r;return function t(e,r,n){function i(o,s){if(!r[o]){if(!e[o]){var u=typeof require=="function"&&require;if(!s&&u)return u(o,!0);if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var f=r[o]={exports:{}};e[o][0].call(f.exports,function(t){var r=e[o][1][t];return i(r?r:t)},f,f.exports,t,e,r,n)}return r[o].exports}var a=typeof require=="function"&&require;for(var o=0;o<n.length;o++)i(n[o]);return i}({1:[function(t,e,r){"use strict";r.Game=t("./lib/game").default;r.Client=t("./lib/client").default;r.utils=t("./lib/utils").default},{"./lib/client":3,"./lib/game":6,"./lib/utils":14}],2:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=function(){function t(t,e){var r=[];var n=true;var i=false;var a=undefined;try{for(var o=t[Symbol.iterator](),s;!(n=(s=o.next()).done);n=true){r.push(s.value);if(e&&r.length===e)break}}catch(t){i=true;a=t}finally{try{if(!n&&o["return"])o["return"]()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){return t(e,r)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var i=t("./utils");var a=f(i);var o=t("./intersection");var s=f(o);var u=t("./zobrist");var l=f(u);function f(t){return t&&t.__esModule?t:{default:t}}var d=function t(e){var r=e.moveNumber,n=e.playedPoint,i=e.color,a=e.pass,o=e.blackPassStones,s=e.whitePassStones,u=e.intersections,f=e.blackStonesCaptured,d=e.whiteStonesCaptured,c=e.capturedPositions,h=e.koPoint,v=e.boardSize;this.moveNumber=r;this.playedPoint=n;this.color=i;this.pass=a;this.blackPassStones=o;this.whitePassStones=s;this.intersections=u;this.blackStonesCaptured=f;this.whiteStonesCaptured=d;this.capturedPositions=c;this.koPoint=h;this.boardSize=v;this._positionHash=l.default.hash(v,u);Object.freeze(this)};d.prototype={copyWithAttributes:function t(e){var r=function t(e){var r=e.moveNumber,n=e.playedPoint,i=e.color,a=e.pass,o=e.blackPassStones,s=e.whitePassStones,u=e.intersections,l=e.blackStonesCaptured,f=e.whiteStonesCaptured,d=e.capturedPositions,c=e.koPoint,h=e.boardSize;return{moveNumber:r,playedPoint:n,color:i,pass:a,blackPassStones:o,whitePassStones:s,intersections:u,blackStonesCaptured:l,whiteStonesCaptured:f,capturedPositions:d,koPoint:c,boardSize:h}};var n=r(this);var i=r(Object.assign(n,e));return new d(i)},_capturesFrom:function t(e,r,n){var i=this;var o=this.neighborsFor(e,r).filter(function(t){return!t.isEmpty()&&t.value!==n&&i.libertiesAt(t.y,t.x)===1});var s=a.default.flatMap(o,function(t){return i.groupAt(t.y,t.x)});return a.default.unique(s)},_updateIntersection:function t(e,r,n){return r.map(function(t){if(t.y===e.y&&t.x===e.x){return new s.default(t.y,t.x,n)}else{return t}})},_removeIntersection:function t(e,r){return this._updateIntersection(e,r,"empty")},_withoutIntersectionsMatching:function t(e){var r=this.intersections.map(function(t){if(e(t)){return new s.default(t.y,t.x,"empty")}else{return t}});return this._withNewPoints(r)},_withNewPoints:function t(e){return this.copyWithAttributes({intersections:e})},nextColor:function t(){if(this.color==="black"){return"white"}else{return"black"}},yCoordinateFor:function t(e){return this.boardSize-e},xCoordinateFor:function t(e){var r=["A","B","C","D","E","F","G","H","J","K","L","M","N","O","P","Q","R","S","T"];return r[e]},playPass:function t(e){var r={moveNumber:this.moveNumber+1,playedPoint:null,color:e,pass:true,blackPassStones:this.blackPassStones,whitePassStones:this.whitePassStones,intersections:this.intersections,blackStonesCaptured:this.blackStonesCaptured,whiteStonesCaptured:this.whiteStonesCaptured,capturedPositions:[],koPoint:null,boardSize:this.boardSize};r[e+"PassStones"]+=1;var n=new d(r);return n},_simpleKoPoint:function t(){var e=null;if(this.playedPoint){var r=this.playedPoint,n=r.y,i=r.x;if(this.capturedPositions.length===1&&this.groupAt(n,i).length===1&&this.inAtari(n,i)){e=this.capturedPositions[0]}}return e},playAt:function t(e,r,n){var i=this;var a=this._capturesFrom(e,r,n);var o=this.intersectionAt(e,r);var s=this.intersections;a.forEach(function(t){s=i._removeIntersection(t,s)});s=this._updateIntersection(o,s,n);var u=this.blackStonesCaptured+(n==="black"?0:a.length);var l=this.whiteStonesCaptured+(n==="white"?0:a.length);var f=this.boardSize;var c={moveNumber:this.moveNumber+1,playedPoint:Object.freeze({y:e,x:r}),color:n,pass:false,blackPassStones:this.blackPassStones,whitePassStones:this.whitePassStones,intersections:s,blackStonesCaptured:u,whiteStonesCaptured:l,capturedPositions:a,boardSize:f};var h=new d(c);var v=h._simpleKoPoint();if(v){c["koPoint"]={y:v.y,x:v.x}}else{c["koPoint"]=null}return new d(c)},intersectionAt:function t(e,r){if(e>=this.boardSize||r>=this.boardSize){throw new Error("Intersection at ("+e+", "+r+") would be outside the board")}if(e<0||r<0){throw new Error("Intersection position cannot be negative, but was given ("+e+", "+r+")")}return this.intersections[e*this.boardSize+r]},groupAt:function t(e,r){var i=this.intersectionAt(e,r);var a=this.partitionTraverse(i,function(t){return t.sameColorAs(i)}),o=n(a,2),s=o[0],u=o[1];return s},libertiesAt:function t(e,r){var n=this;var i=this.intersectionAt(e,r);var o=a.default.flatMap(this.groupAt(i.y,i.x),function(t){return n.neighborsFor(t.y,t.x).filter(function(t){return t.isEmpty()})});return a.default.unique(o).length},inAtari:function t(e,r){return this.libertiesAt(e,r)===1},neighborsFor:function t(e,r){var n=[];if(r>0){n.push(this.intersectionAt(e,r-1))}if(r<this.boardSize-1){n.push(this.intersectionAt(e,r+1))}if(e>0){n.push(this.intersectionAt(e-1,r))}if(e<this.boardSize-1){n.push(this.intersectionAt(e+1,r))}return n},positionSameAs:function t(e){return this._positionHash===e._positionHash&&this.intersections.every(function(t){return t.sameColorAs(e.intersectionAt(t.y,t.x))})},partitionTraverse:function t(e,r){var n=[];var i=[];var o=[];o.push(e);while(o.length>0){var s=o.pop();if(n.indexOf(s)>-1){}else{n.push(s);this.neighborsFor(s.y,s.x).forEach(function(t){if(n.indexOf(t)>-1){}else{if(r(t)){o.push(t)}else{i.push(t)}}})}}return[n,a.default.unique(i)]}};d._initialFor=function(t,e){this._cache=this._cache||{};this._cache[t]=this._cache[t]||{};if(this._cache[t][e]){return this._cache[t][e]}var r=Array.apply(null,Array(t*t));r=r.map(function(e,r){return new s.default(Math.floor(r/t),r%t)});var n=t>11?3:2;var i={topRight:{y:n,x:t-n-1},bottomLeft:{y:t-n-1,x:n},bottomRight:{y:t-n-1,x:t-n-1},topLeft:{y:n,x:n},middle:{y:(t+1)/2-1,x:(t+1)/2-1},middleLeft:{y:(t+1)/2-1,x:n},middleRight:{y:(t+1)/2-1,x:t-n-1},middleTop:{y:n,x:(t+1)/2-1},middleBottom:{y:t-n-1,x:(t+1)/2-1}};var a={0:[],1:[],2:[i.topRight,i.bottomLeft],3:[i.topRight,i.bottomLeft,i.bottomRight],4:[i.topRight,i.bottomLeft,i.bottomRight,i.topLeft],5:[i.topRight,i.bottomLeft,i.bottomRight,i.topLeft,i.middle],6:[i.topRight,i.bottomLeft,i.bottomRight,i.topLeft,i.middleLeft,i.middleRight],7:[i.topRight,i.bottomLeft,i.bottomRight,i.topLeft,i.middleLeft,i.middleRight,i.middle],8:[i.topRight,i.bottomLeft,i.bottomRight,i.topLeft,i.middleLeft,i.middleRight,i.middleTop,i.middleBottom],9:[i.topRight,i.bottomLeft,i.bottomRight,i.topLeft,i.middleLeft,i.middleRight,i.middleTop,i.middleBottom,i.middle]};a[e].forEach(function(e){r[e.y*t+e.x]=new s.default(e.y,e.x,"black")});var o=new d({color:e>1?"black":"white",moveNumber:0,intersections:Object.freeze(r),blackStonesCaptured:0,whiteStonesCaptured:0,whitePassStones:0,blackPassStones:0,boardSize:t});this._cache[t][e]=o;return o};r.default=d},{"./intersection":7,"./utils":14,"./zobrist":15}],3:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=t("./game");var i=a(n);function a(t){return t&&t.__esModule?t:{default:t}}function o(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++){r[e]=t[e]}return r}else{return Array.from(t)}}var s=function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this._boardElement=e["element"];this._setup(e)};s.prototype={_setup:function t(e){var r=this;var n=e.player,a=e.gameOptions,s=e.hooks;this._player=n;this._hooks=s;if(this._player!=="black"&&this._player!=="white"){throw new Error("Player must be either black or white, but was given: "+this._player)}a["_hooks"]={handleClick:function t(e,n){if(r._busy){return}r._busy=true;if(r.isOver()){var i=r._game.currentState().groupAt(e,n).map(function(t){return{y:t.y,x:t.x,color:t.color}});r._hooks.submitMarkDeadAt(e,n,i,function(t){if(t){r._game.toggleDeadAt(e,n)}r._busy=false})}else{if(r._player!==r.currentPlayer()||r._game.isIllegalAt(e,n)){r._busy=false;return}r._hooks.submitPlay(e,n,function(t){if(t){r._game.playAt(e,n)}r._busy=false})}},hoverValue:function t(e,n){if(!r._busy&&r._player===r.currentPlayer()&&!r.isOver()&&!r._game.isIllegalAt(e,n)){return r._player}},gameIsOver:function t(){return r.isOver()}};if(this._boardElement){this._game=new i.default(Object.assign({element:this._boardElement},a))}else{this._game=new(Function.prototype.bind.apply(i.default,[null].concat(o(a))))}},isOver:function t(){return this._game.isOver()},currentPlayer:function t(){return this._game.currentPlayer()},receivePlay:function t(e,r){if(this._player===this.currentPlayer()){return}this._game.playAt(e,r)},moveNumber:function t(){return this._game.moveNumber()},receivePass:function t(){if(this._player===this.currentPlayer()){return}this._game.pass()},receiveMarkDeadAt:function t(e,r){this._game.toggleDeadAt(e,r)},deadStones:function t(){return this._game.deadStones()},setDeadStones:function t(e){this._game._deadPoints=e.map(function(t){return{y:t.y,x:t.x}});this._game.render()},pass:function t(){var e=this;if(this._busy||this._player!==this.currentPlayer()||this.isOver()){return}this._busy=true;this._hooks.submitPass(function(t){if(t){e._game.pass()}e._busy=false})}};r.default=s},{"./game":6}],4:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=t("./utils");var i=s(n);var a=t("./renderer");var o=s(a);function s(t){return t&&t.__esModule?t:{default:t}}var u=function t(e,r){var n=r.hooks,a=r.options;o.default.call(this,e,{hooks:n,options:a});if(this.smallerStones){i.default.addClass(e,"tenuki-smaller-stones")}i.default.addClass(e,"tenuki-dom-renderer")};u.prototype=Object.create(o.default.prototype);u.prototype.constructor=u;u.prototype._setup=function(t){o.default.prototype._setup.call(this,t);this.BOARD_LENGTH+=1;this.computeSizing()};u.prototype.generateBoard=function(t){var e=this;var r=i.default.createElement("div");i.default.appendElement(r,i.default.createElement("div",{class:"lines horizontal"}));i.default.appendElement(r,i.default.createElement("div",{class:"lines vertical"}));i.default.appendElement(r,i.default.createElement("div",{class:"hoshi-points"}));i.default.appendElement(r,i.default.createElement("div",{class:"intersections"}));o.default.hoshiPositionsFor(t.boardSize).forEach(function(t){var n=i.default.createElement("div",{class:"hoshi"});n.style.left=t.left*(e.INTERSECTION_GAP_SIZE+1)+"px";n.style.top=t.top*(e.INTERSECTION_GAP_SIZE+1)+"px";i.default.appendElement(r.querySelector(".hoshi-points"),n)});for(var n=0;n<t.boardSize;n++){var a=i.default.createElement("div",{class:"line horizontal"});a.setAttribute("data-left-gutter",t.yCoordinateFor(n));i.default.appendElement(r.querySelector(".lines.horizontal"),a);var s=i.default.createElement("div",{class:"line vertical"});s.setAttribute("data-top-gutter",t.xCoordinateFor(n));i.default.appendElement(r.querySelector(".lines.vertical"),s);for(var u=0;u<t.boardSize;u++){var l=i.default.createElement("div",{class:"intersection empty"});var f=i.default.createElement("div",{class:"stone"});i.default.appendElement(l,f);l.setAttribute("data-position-x",u);l.setAttribute("data-position-y",n);l.style.left=u*(this.INTERSECTION_GAP_SIZE+1)+"px";l.style.top=n*(this.INTERSECTION_GAP_SIZE+1)+"px";i.default.appendElement(r.querySelector(".intersections"),l);this.grid[n]=this.grid[n]||[];this.grid[n][u]=l;this.addIntersectionEventListeners(l,n,u)}}i.default.addEventListener(r.querySelector(".lines.horizontal"),"mousedown",function(t){t.preventDefault()});i.default.addEventListener(r.querySelector(".lines.vertical"),"mousedown",function(t){t.preventDefault()});r.querySelector(".lines.horizontal").style.width=this.INTERSECTION_GAP_SIZE*(t.boardSize-1)+t.boardSize+"px";r.querySelector(".lines.horizontal").style.height=this.INTERSECTION_GAP_SIZE*(t.boardSize-1)+t.boardSize+"px";r.querySelector(".lines.vertical").style.width=this.INTERSECTION_GAP_SIZE*(t.boardSize-1)+t.boardSize+"px";r.querySelector(".lines.vertical").style.height=this.INTERSECTION_GAP_SIZE*(t.boardSize-1)+t.boardSize+"px";return r};u.prototype.setIntersectionClasses=function(t,e,r){if(t.className!==r.join(" ")){t.className=r.join(" ")}};r.default=u},{"./renderer":10,"./utils":14}],5:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=function t(e,r){this.boardState=e;this.intersection=r;Object.freeze(this)};n.prototype={diagonals:function t(){var e=this;var t=[];var r=[];var n=[];if(this.intersection.x>0){r.push(this.intersection.x-1)}if(this.intersection.x<this.boardState.boardSize-1){r.push(this.intersection.x+1)}if(this.intersection.y>0){n.push(this.intersection.y-1)}if(this.intersection.y<this.boardState.boardSize-1){n.push(this.intersection.y+1)}r.forEach(function(r){n.forEach(function(n){t.push(e.boardState.intersectionAt(n,r))})});return t},isFalse:function t(){if(!this.intersection.isEmpty()){return false}var e=this.diagonals();var r=e.length<=2;var n=this.neighbors();var i=n.filter(function(t){return!t.isEmpty()});if(r&&i.length<1){return false}if(!r&&i.length<2){return false}var a=e.filter(function(t){return!t.isEmpty()&&!t.sameColorAs(i[0])});if(r){return a.length>=1}else{return a.length>=2}},neighbors:function t(){return this.boardState.neighborsFor(this.intersection.y,this.intersection.x)},filledColor:function t(){if(!this.isFalse()){throw new Error("Attempting to find filled color for a non-false eye")}return this.neighbors()[0].value}};r.default=n},{}],6:[function(t,e,r){"use strict";var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Object.defineProperty(r,"__esModule",{value:true});var i=function(){function t(t,e){var r=[];var n=true;var i=false;var a=undefined;try{for(var o=t[Symbol.iterator](),s;!(n=(s=o.next()).done);n=true){r.push(s.value);if(e&&r.length===e)break}}catch(t){i=true;a=t}finally{try{if(!n&&o["return"])o["return"]()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){return t(e,r)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var a=typeof Symbol==="function"&&n(Symbol.iterator)==="symbol"?function(t){return typeof t==="undefined"?"undefined":n(t)}:function(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t==="undefined"?"undefined":n(t)};var o=t("./dom-renderer");var s=b(o);var u=t("./svg-renderer");var l=b(u);var f=t("./null-renderer");var d=b(f);var c=t("./board-state");var h=b(c);var v=t("./ruleset");var p=b(v);var m=t("./scorer");var y=b(m);function b(t){return t&&t.__esModule?t:{default:t}}var S=["element","boardSize","scoring","handicapStones","koRule","komi","_hooks","fuzzyStonePlacement","renderer","freeHandicapPlacement"];var E=function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this._validateOptions(e);this._defaultBoardSize=19;this.boardSize=null;this._moves=[];this.callbacks={postRender:function t(){}};this._boardElement=e["element"];this._defaultScoring="territory";this._defaultKoRule="simple";this._defaultRenderer="svg";this._deadPoints=[];this._setup(e)};E.prototype={_validateOptions:function t(e){for(var r in e){if(e.hasOwnProperty(r)){if(S.indexOf(r)<0){throw new Error("Unrecognized game option: "+r)}if(typeof e[r]==="undefined"||e[r]===null){throw new Error("Game option "+r+" must not be set as null or undefined")}}}},_configureOptions:function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},r=e.boardSize,n=r===undefined?this._defaultBoardSize:r,i=e.komi,o=i===undefined?0:i,u=e.handicapStones,f=u===undefined?0:u,d=e.freeHandicapPlacement,c=d===undefined?false:d,v=e.scoring,m=v===undefined?this._defaultScoring:v,b=e.koRule,S=b===undefined?this._defaultKoRule:b,E=e.renderer,g=E===undefined?this._defaultRenderer:E;if(typeof n!=="number"){throw new Error("Board size must be a number, but was: "+(typeof n==="undefined"?"undefined":a(n)))}if(typeof f!=="number"){throw new Error("Handicap stones must be a number, but was: "+(typeof n==="undefined"?"undefined":a(n)))}if(f>0&&n!==9&&n!==13&&n!==19){throw new Error("Handicap stones not supported on sizes other than 9x9, 13x13 and 19x19")}if(f<0||f===1||f>9){throw new Error("Only 2 to 9 handicap stones are supported")}if(n>19){throw new Error("cannot generate a board size greater than 19")}this.boardSize=n;this.handicapStones=f;this._freeHandicapPlacement=c;this._scorer=new y.default({scoreBy:m,komi:o});this._rendererChoice={dom:s.default,svg:l.default}[g];if(!this._rendererChoice){throw new Error("Unknown renderer: "+g)}this._ruleset=new p.default({koRule:S});if(this._freeHandicapPlacement){this._initialState=h.default._initialFor(n,0)}else{this._initialState=h.default._initialFor(n,f)}},_stillPlayingHandicapStones:function t(){return this._freeHandicapPlacement&&this.handicapStones>0&&this._moves.length<this.handicapStones},_setup:function t(){var e=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this._validateOptions(r);this._configureOptions(r);if(this._boardElement){var n={handleClick:function t(r,n){if(e.isOver()){e.toggleDeadAt(r,n)}else{e.playAt(r,n)}},hoverValue:function t(r,n){if(!e.isOver()&&!e.isIllegalAt(r,n)){return e.currentPlayer()}},gameIsOver:function t(){return e.isOver()}};this.renderer=new this._rendererChoice(this._boardElement,{hooks:r["_hooks"]||n,options:{fuzzyStonePlacement:r["fuzzyStonePlacement"]}})}else{this.renderer=new d.default}this.render()},intersectionAt:function t(e,r){return this.currentState().intersectionAt(e,r)},intersections:function t(){return this.currentState().intersections},deadStones:function t(){return this._deadPoints},coordinatesFor:function t(e,r){return this.currentState().xCoordinateFor(r)+this.currentState().yCoordinateFor(e)},currentPlayer:function t(){if(this._stillPlayingHandicapStones()){return"black"}return this.currentState().nextColor()},isWhitePlaying:function t(){return this.currentPlayer()==="white"},isBlackPlaying:function t(){return this.currentPlayer()==="black"},score:function t(){return this._scorer.score(this)},currentState:function t(){return this._moves[this._moves.length-1]||this._initialState},moveNumber:function t(){return this.currentState().moveNumber},playAt:function t(e,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},i=n.render,a=i===undefined?true:i;if(this.isIllegalAt(e,r)){return false}var o=this.currentState().playAt(e,r,this.currentPlayer());var s=o,u=s.koPoint;if(u&&!this._ruleset._isKoViolation(u.y,u.x,o,this._moves.concat(o))){o=o.copyWithAttributes({koPoint:null})}this._moves.push(o);if(a){this.render()}return true},pass:function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},r=e.render,n=r===undefined?true:r;if(this.isOver()){return false}var i=this.currentState().playPass(this.currentPlayer());this._moves.push(i);if(n){this.render()}return true},isOver:function t(){if(this._moves.length<2){return false}var e=this._moves[this._moves.length-1];var r=this._moves[this._moves.length-2];return e.pass&&r.pass},markDeadAt:function t(e,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},i=n.render,a=i===undefined?true:i;if(this._isDeadAt(e,r)){return true}return this._setDeadStatus(e,r,true,{render:a})},unmarkDeadAt:function t(e,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},i=n.render,a=i===undefined?true:i;if(!this._isDeadAt(e,r)){return true}return this._setDeadStatus(e,r,false,{render:a})},toggleDeadAt:function t(e,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},i=n.render,a=i===undefined?true:i;return this._setDeadStatus(e,r,!this._isDeadAt(e,r),{render:a})},_setDeadStatus:function t(e,r,n){var a=this;var o=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{},s=o.render,u=s===undefined?true:s;var l=this.intersectionAt(e,r);if(l.isEmpty()){return}var f=[];var d=this.currentState().partitionTraverse(l,function(t){return t.isEmpty()||t.sameColorAs(l)}),c=i(d,1),h=c[0];h.forEach(function(t){if(!t.isEmpty()){f.push(t)}});f.forEach(function(t){if(n){a._deadPoints.push({y:t.y,x:t.x})}else{a._deadPoints=a._deadPoints.filter(function(e){return!(e.y===t.y&&e.x===t.x)})}});if(u){this.render()}return true},_isDeadAt:function t(e,r){return this._deadPoints.some(function(t){return t.y===e&&t.x===r})},isIllegalAt:function t(e,r){return this._ruleset.isIllegal(e,r,this)},territory:function t(){if(!this.isOver()){return{black:[],white:[]}}return this._scorer.territory(this)},undo:function t(){this._moves.pop();this.render()},render:function t(){if(!this.isOver()){this._deadPoints=[]}this.renderer.render(this.currentState(),{territory:this.territory(),deadStones:this.deadStones()});this.callbacks.postRender(this)}};r.default=E},{"./board-state":2,"./dom-renderer":4,"./null-renderer":8,"./ruleset":11,"./scorer":12,"./svg-renderer":13}],7:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=function t(e,r,n){this.y=e;this.x=r;this.value=n||"empty";Object.freeze(this)};n.prototype={isOccupiedWith:function t(e){if(this.isEmpty()){return false}return this.value===e},isBlack:function t(){return this.value==="black"},isWhite:function t(){return this.value==="white"},isEmpty:function t(){return this.value==="empty"},sameColorAs:function t(e){return this.value===e.value}};r.default=n},{}],8:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.default=n;function n(){this.setup=function(){};this.render=function(){};this.renderTerritory=function(){}}},{}],9:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=function(){function t(t,e){var r=[];var n=true;var i=false;var a=undefined;try{for(var o=t[Symbol.iterator](),s;!(n=(s=o.next()).done);n=true){r.push(s.value);if(e&&r.length===e)break}}catch(t){i=true;a=t}finally{try{if(!n&&o["return"])o["return"]()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){return t(e,r)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var i=t("./utils");var a=o(i);function o(t){return t&&t.__esModule?t:{default:t}}var s=function t(e,r){this.boardState=e;this.intersections=r;this._computed={};Object.freeze(this)};s._startingAt=function(t,e,r){var i=t.intersectionAt(e,r);var a=t.partitionTraverse(i,function(t){return t.sameColorAs(i)}),o=n(a,2),s=o[0],u=o[1];return[s,u]};s.allFor=function(t){var e=[];var r=[];t.intersections.forEach(function(i){if(e.indexOf(i)>-1){}else{var a=t.partitionTraverse(i,function(t){return t.sameColorAs(i)}),o=n(a,2),u=o[0],l=o[1];r.push(new s(t,u));e=e.concat(u)}});return r};s.merge=function(t,e){var r=[e];var n=-1;while(r.length!==n){n=r.length;r=t.filter(function(t){return t.isEmpty()&&t.isTerritory()&&t.territoryColor()===e.territoryColor()&&t.expandedBoundaryStones().some(function(t){return r.some(function(e){return e.expandedBoundaryStones().indexOf(t)>-1})})})}return r};s.prototype={isEmpty:function t(){return this.intersections[0].isEmpty()},isTerritory:function t(){var e=this.intersections[0];if(!e.isEmpty()){return false}var r=s._startingAt(this.boardState,e.y,e.x),i=n(r,2),o=i[0],u=i[1];var l=a.default.unique(u.map(function(t){return t.value}));var t=l.length===1&&l[0]!=="empty";return t},territoryColor:function t(){var e=this.intersections[0];var r=s._startingAt(this.boardState,e.y,e.x),i=n(r,2),o=i[0],u=i[1];var l=a.default.unique(u.map(function(t){return t.value}));var f=l.length===1&&l[0]!=="empty";if(!e.isEmpty()||!f){throw new Error("Attempted to obtain territory color for something that isn't territory, region containing "+e.y+","+e.x)}else{return l[0]}},isBlack:function t(){return this.territoryColor()==="black"},isWhite:function t(){return this.territoryColor()==="white"},isNeutral:function t(){return!this.intersections[0].isBlack()&&!this.intersections[0].isWhite()&&!this.isTerritory()},exterior:function t(){var e=this;return this.boardState.intersections.filter(function(t){return e.intersections.indexOf(t)<0&&e.boardState.neighborsFor(t.y,t.x).some(function(t){return e.intersections.indexOf(t)>-1})})},boundaryStones:function t(){var e=this;if(this._computed.boundaryStones){return this._computed.boundaryStones}if(!this.isEmpty()){throw new Error("Attempted to obtain boundary stones for non-empty region")}this._computed.boundaryStones=this.exterior().filter(function(t){return!t.sameColorAs(e.intersections[0])});return this._computed.boundaryStones},expandedBoundaryStones:function t(){if(this._computed.expandedBoundaryStones){return this._computed.expandedBoundaryStones}var e=this.boundaryStones();var r=s.allFor(this.boardState).filter(function(t){return t.intersections.some(function(t){return e.indexOf(t)>-1})});this._computed.expandedBoundaryStones=a.default.flatMap(r,function(t){return t.intersections});return this._computed.expandedBoundaryStones},lengthOfTerritoryBoundary:function t(){var e=this;var r=this.intersections.filter(function(t){return t.y===0||t.y===e.boardState.boardSize-1||t.x===0||t.x===e.boardState.boardSize-1});var n=this.intersections.filter(function(t){return t.y%e.boardState.boardSize-1===0&&t.x%e.boardState.boardSize-1===0});return this.boundaryStones().length+r.length+n.length},containsSquareFour:function t(){var e=this;return this.intersections.some(function(t){return[[0,0],[0,1],[1,0],[1,1]].every(function(r){var i=n(r,2),a=i[0],o=i[1];var s=t.y+a;var u=t.x+o;var l=s>=0&&s<e.boardState.boardSize&&u>=0&&u<e.boardState.boardSize;return l&&e.boardState.intersectionAt(s,u).sameColorAs(t)})})},containsCurvedFour:function t(){var e=this;return this.intersections.some(function(t){return[[[0,0],[1,0],[2,0],[2,1]],[[-1,2],[0,0],[0,1],[0,2]],[[0,0],[0,1],[1,1],[2,1]],[[-1,0],[-1,1],[-1,2],[0,0]],[[-2,1],[-1,1],[0,0],[0,1]],[[0,0],[1,0],[1,1],[1,2]],[[0,-1],[0,0],[1,-1],[2,-1]],[[-1,-2],[-1,-1],[-1,0],[0,0]]].some(function(r){return r.every(function(r){var i=n(r,2),a=i[0],o=i[1];var s=t.y+a;var u=t.x+o;var l=s>=0&&s<e.boardState.boardSize&&u>=0&&u<e.boardState.boardSize;return l&&e.boardState.intersectionAt(s,u).sameColorAs(t)})})})},numberOfEyes:function t(){if(!this.intersections[0].isEmpty()){throw new Error("Unexpected calculation of number of eyes for a non-empty region containing "+this.intersections[0].y+","+this.intersections[0].x)}var e=this.lengthOfTerritoryBoundary();if(e<2){throw new Error("Unexpected boundary length of "+e+" for region including "+this.intersections[0].y+","+this.intersections[0].x)}if(e>=10){return 2}var r=void 0;switch(e){case 2:case 3:case 4:case 5:case 6:r=1;break;case 7:r=1.5;break;case 8:if(this.containsSquareFour()){r=1}else if(this.containsCurvedFour()){r=2}else{r=1.5}break;case 9:if(this.containsSquareFour()){r=1.5}else{r=2}break;default:throw new Error("unhandled boundary length "+e)}return r}};r.default=s},{"./utils":14}],10:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=function(){function t(t,e){var r=[];var n=true;var i=false;var a=undefined;try{for(var o=t[Symbol.iterator](),s;!(n=(s=o.next()).done);n=true){r.push(s.value);if(e&&r.length===e)break}}catch(t){i=true;a=t}finally{try{if(!n&&o["return"])o["return"]()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){return t(e,r)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var i=t("./utils");var a=o(i);function o(t){return t&&t.__esModule?t:{default:t}}var s=function t(e,r){var n=r.hooks,i=r.options;this.INTERSECTION_GAP_SIZE=28;this.GUTTER_MARGIN=this.INTERSECTION_GAP_SIZE-3;this.BASE_MARGIN=this.INTERSECTION_GAP_SIZE-10;this.hasCoordinates=e.hasAttribute("data-include-coordinates");this.MARGIN=this.hasCoordinates?this.BASE_MARGIN+this.GUTTER_MARGIN:this.BASE_MARGIN;this.boardElement=e;this.grid=[];this.hooks=n||{};this._options=i||{};this._initialized=false;if(this._options["fuzzyStonePlacement"]){a.default.addClass(e,"tenuki-fuzzy-placement");a.default.removeClass(e,"tenuki-board-flat");a.default.addClass(e,"tenuki-board-nonflat");this.smallerStones=true}this.flatStones=a.default.hasClass(e,"tenuki-board-flat");if(!this.flatStones){a.default.addClass(e,"tenuki-board-nonflat")}};s.hoshiPositionsFor=function(t){var e=[];if(t<7){if(t>1&&t%2===1){var r={};r.top=(t-1)/2;r.left=r.top;e.push(r)}else{}}else{var n=t>11?3:2;for(var i=0;i<3;i++){for(var a=0;a<3;a++){if((t===7||t%2===0)&&(i===1||a===1)){continue}var o={};if(i===0){o.top=n}if(i===1){o.top=(t+1)/2-1}if(i===2){o.top=t-n-1}if(a===0){o.left=n}if(a===1){o.left=(t+1)/2-1}if(a===2){o.left=t-n-1}e.push(o)}}}return e};s.prototype={_setup:function t(e){var r=this;var n=this.boardElement;r.BOARD_LENGTH=2*this.MARGIN+(e.boardSize-1)*(this.INTERSECTION_GAP_SIZE+1);var i=a.default.createElement("div",{class:"tenuki-inner-container"});r.innerContainer=i;a.default.appendElement(n,i);var o=a.default.createElement("div",{class:"tenuki-zoom-container"});r.zoomContainer=o;a.default.appendElement(i,o);r.cancelZoomElement=a.default.createElement("div",{class:"cancel-zoom"});var s=a.default.createElement("div",{class:"cancel-zoom-backdrop"});a.default.addEventListener(r.cancelZoomElement,"click",function(t){t.preventDefault();r.zoomOut();return false});a.default.addEventListener(s,"click",function(t){t.preventDefault();r.zoomOut();return false});a.default.appendElement(i,r.cancelZoomElement);a.default.appendElement(i,s);var u=function t(e,r){var n=false;var i=function t(){if(n){return}n=true;window.requestAnimationFrame(function(){window.dispatchEvent(new CustomEvent(r));n=false})};window.addEventListener(e,i)};u("resize","optimizedResize");var l=this.generateBoard(e,{hasCoordinates:this.hasCoordinates,smallerStones:this.smallerStones,flatStones:this.flatStones});a.default.appendElement(o,l);window.requestAnimationFrame(function(){o.style.willChange="transform";r.computeSizing()});window.addEventListener("optimizedResize",function(){r.computeSizing()});r.touchmoveChangedTouch=null;r.touchstartEventHandler=r.handleTouchStart.bind(r);r.touchmoveEventHandler=r.handleTouchMove.bind(r);r.touchendEventHandler=r.handleTouchEnd.bind(r);a.default.addEventListener(r.innerContainer,"touchstart",r.touchstartEventHandler);a.default.addEventListener(r.innerContainer,"touchend",r.touchendEventHandler);a.default.addEventListener(r.innerContainer,"touchmove",r.touchmoveEventHandler)},computeSizing:function t(){var e=this;var r=this.innerContainer;var n=this.zoomContainer;var i=this.boardElement;r.style.height="";r.style.width="";n.style.height="";n.style.width="";r.style.transform="";i.style.width="";i.style.height="";e._touchEventFired=null;r.style.width=e.BOARD_LENGTH+"px";r.style.height=e.BOARD_LENGTH+"px";n.style.width=e.BOARD_LENGTH+"px";n.style.height=e.BOARD_LENGTH+"px";var o=r.parentNode.clientWidth/r.clientWidth;var s=r.parentNode.clientHeight/r.clientHeight;var u=Math.min(o,s);if(u>0){if(u<1){a.default.addClass(i,"tenuki-scaled")}else{a.default.removeClass(i,"tenuki-scaled")}if(u<1||u>1){r.style["transform-origin"]="top left";r.style.transform="scale3d("+u+", "+u+", 1)"}}i.style.width=r.getBoundingClientRect().width+"px";i.style.height=r.getBoundingClientRect().height+"px";n.style.willChange="";window.requestAnimationFrame(function(){n.style.willChange="transform"})},addIntersectionEventListeners:function t(e,r,n){var i=this;a.default.addEventListener(e,"mouseenter",function(){var t=r;var o=n;var s=i.hooks.hoverValue(t,o);if(s){a.default.addClass(e,"hovered");a.default.addClass(e,s)}});a.default.addEventListener(e,"mouseleave",function(){if(a.default.hasClass(this,"hovered")){a.default.removeClass(e,"hovered");a.default.removeClass(e,"black");a.default.removeClass(e,"white")}i.resetTouchedPoint()});a.default.addEventListener(e,"click",function(){var t=r;var a=n;if(!i._touchEventFired||document.body.clientWidth/window.innerWidth>1||i.hooks.gameIsOver()){i.hooks.handleClick(t,a);return}if(i.touchedPoint){if(e===i.touchedPoint){i.hooks.handleClick(t,a)}else{i.showPossibleMoveAt(e,t,a)}}else{i.showPossibleMoveAt(e,t,a)}})},handleTouchStart:function t(e){var r=this;r._touchEventFired=true;if(e.touches.length>1){if(r.zoomedIn){e.preventDefault()}return}if(!r.zoomedIn){return}var n=e.changedTouches[0].clientX;var i=e.changedTouches[0].clientY;r.dragStartX=n;r.dragStartY=i;r.zoomContainer.style.transition="none";r.animationFrameRequestID=window.requestAnimationFrame(r.processDragDelta.bind(r))},handleTouchMove:function t(e){var r=this;if(e.touches.length>1){return}if(!r.zoomedIn){return true}e.preventDefault();r.touchmoveChangedTouch=e.changedTouches[0];r.moveInProgress=true},handleTouchEnd:function t(e){var r=this;if(e.touches.length>1){return}if(!r.zoomedIn){return}r.zoomContainer.style.transition="";if(!r.moveInProgress){return}r.translateY=r.lastTranslateY;r.translateX=r.lastTranslateX;r.moveInProgress=false;r.touchmoveChangedTouch=null;window.cancelAnimationFrame(r.animationFrameRequestID)},processDragDelta:function t(){var e=this;if(!e.touchmoveChangedTouch){e.animationFrameRequestID=window.requestAnimationFrame(e.processDragDelta.bind(e));return}var r=e.innerContainer;var n=e.touchmoveChangedTouch.clientX;var i=e.touchmoveChangedTouch.clientY;var a=n-e.dragStartX;var o=i-e.dragStartY;var s=e.translateY+o/2.5;var u=e.translateX+a/2.5;if(s>.5*r.clientHeight-e.MARGIN){s=.5*r.clientHeight-e.MARGIN}if(u>.5*r.clientWidth-e.MARGIN){u=.5*r.clientWidth-e.MARGIN}if(s<-.5*r.clientHeight+e.MARGIN){s=-.5*r.clientHeight+e.MARGIN}if(u<-.5*r.clientWidth+e.MARGIN){u=-.5*r.clientWidth+e.MARGIN}e.zoomContainer.style.transform="translate3d("+2.5*u+"px, "+2.5*s+"px, 0) scale3d(2.5, 2.5, 1)";e.lastTranslateX=u;e.lastTranslateY=s;e.animationFrameRequestID=window.requestAnimationFrame(e.processDragDelta.bind(e))},showPossibleMoveAt:function t(e,r,n){var i=this;var o=this.boardElement;var s=this.zoomContainer;i.zoomContainerHeight=i.zoomContainerHeight||s.clientHeight;i.zoomContainerWidth=i.zoomContainerWidth||s.clientWidth;i.touchedPoint=e;if(a.default.hasClass(o,"tenuki-scaled")){var u=r*(this.INTERSECTION_GAP_SIZE+1);var l=n*(this.INTERSECTION_GAP_SIZE+1);var f=.5*i.zoomContainerHeight-u-i.MARGIN;var d=.5*i.zoomContainerWidth-l-i.MARGIN;s.style.transform="translate3d("+2.5*d+"px, "+2.5*f+"px, 0) scale3d(2.5, 2.5, 1)";i.translateY=f;i.translateX=d;a.default.addClass(i.cancelZoomElement,"visible");i.zoomedIn=true}},resetTouchedPoint:function t(){var e=this;e.touchedPoint=null},zoomOut:function t(){var e=this;this.resetTouchedPoint();e.zoomContainer.style.transform="";e.zoomContainer.style.transition="";e.dragStartX=null;e.dragStartY=null;e.translateY=null;e.translateX=null;e.lastTranslateX=null;e.lastTranslateY=null;a.default.removeClass(e.cancelZoomElement,"visible");e.zoomedIn=false},render:function t(e){var r=this;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},o=i.territory,s=i.deadStones;if(!this._initialized){this._setup(e);this._initialized=true}this.resetTouchedPoint();this.renderStonesPlayed(e.intersections);var u=e.playedPoint;this.updateMarkerPoints({playedPoint:u,koPoint:e.koPoint});if(this._options["fuzzyStonePlacement"]&&u){var l=["v-shift-up","v-shift-upup","v-shift-down","v-shift-downdown","v-shift-none"];var f=["h-shift-left","h-shift-leftleft","h-shift-right","h-shift-rightright","h-shift-none"];var d=l.concat(f);var c=d.some(function(t){return a.default.hasClass(r.grid[u.y][u.x],t)});if(!c){var h=a.default.cartesianProduct(l,f);var v=n(h[Math.floor(Math.random()*h.length)],2),p=v[0],m=v[1];[[-1,0],[0,-1],[0,1],[1,0]].forEach(function(t){var e=n(t,2),i=e[0],o=e[1];if(r.grid[u.y+i]&&r.grid[u.y+i][u.x+o]){var s=r.grid[u.y+i][u.x+o];if(!a.default.hasClass(s,"empty")){[[-1,0,"v-shift-downdown","v-shift-up","v-shift-down"],[-1,0,"v-shift-downdown","v-shift-upup","v-shift-none"],[-1,0,"v-shift-down","v-shift-upup","v-shift-none"],[1,0,"v-shift-upup","v-shift-down","v-shift-up"],[1,0,"v-shift-upup","v-shift-downdown","v-shift-none"],[1,0,"v-shift-up","v-shift-downdown","v-shift-none"],[0,-1,"h-shift-rightright","h-shift-left","h-shift-right"],[0,-1,"h-shift-rightright","h-shift-leftleft","h-shift-none"],[0,-1,"h-shift-right","h-shift-leftleft","h-shift-none"],[0,1,"h-shift-leftleft","h-shift-right","h-shift-left"],[0,1,"h-shift-leftleft","h-shift-rightright","h-shift-none"],[0,1,"h-shift-left","h-shift-rightright","h-shift-none"]].forEach(function(t){var e=n(t,5),r=e[0],u=e[1],l=e[2],f=e[3],d=e[4];if(i===r&&o===u&&a.default.hasClass(s,l)&&(p===f||m===f)){a.default.removeClass(s,l);a.default.addClass(s,d)}})}}});a.default.addClass(this.grid[u.y][u.x],p);a.default.addClass(this.grid[u.y][u.x],m)}}if(s.length>0||o.black.length>0||o.white.length>0){this.renderTerritory(o,s)}},renderStonesPlayed:function t(e){var r=this;e.forEach(function(t){r.renderIntersection(t)})},updateMarkerPoints:function t(e){var r=e.playedPoint,n=e.koPoint;var i=this;if(n){a.default.addClass(i.grid[n.y][n.x],"ko")}if(r){a.default.addClass(i.grid[r.y][r.x],"played")}},renderIntersection:function t(e){var r=this;var n=r.grid[e.y][e.x];var i=["intersection"];if(e.isEmpty()){i.push("empty")}else{i.push("occupied");if(e.isBlack()){i.push("black")}else{i.push("white")}var o=["v-shift-up","v-shift-upup","v-shift-down","v-shift-downdown","v-shift-none","h-shift-left","h-shift-leftleft","h-shift-right","h-shift-rightright","h-shift-none"];o.forEach(function(t){if(a.default.hasClass(n,t)){i.push(t)}})}this.setIntersectionClasses(n,e,i)},renderTerritory:function t(e,r){var n=this;a.default.flatten(this.grid).forEach(function(t){a.default.removeClass(t,"territory-black");a.default.removeClass(t,"territory-white");a.default.removeClass(t,"dead")});r.forEach(function(t){a.default.addClass(n.grid[t.y][t.x],"dead")});e.black.forEach(function(t){a.default.addClass(n.grid[t.y][t.x],"territory-black")});e.white.forEach(function(t){a.default.addClass(n.grid[t.y][t.x],"territory-white")})}};r.default=s},{"./utils":14}],11:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=["simple","positional-superko","situational-superko","natural-situational-superko"];var i=function t(e){var r=e.koRule;this.koRule=r;if(n.indexOf(this.koRule)<0){throw new Error("Unknown ko rule: "+r)}Object.freeze(this)};i.prototype={isIllegal:function t(e,r,n){var i=n.currentState();var a=i.intersectionAt(e,r);var o=!a.isEmpty()||this._wouldBeSuicide(e,r,i)||this._isKoViolation(e,r,i,n._moves);return o},_isKoViolation:function t(e,r,n,i){var a=false;if(this.koRule==="simple"){var o=n._simpleKoPoint();a=Boolean(o)&&e===o.y&&r===o.x}else{var s=n.playAt(e,r,n.nextColor());var u=function t(e){return i.length>0&&i.some(function(t){return e(t)&&t.positionSameAs(s)})};if(this.koRule==="positional-superko"){a=u(function(){return true})}else if(this.koRule==="situational-superko"){a=u(function(t){return t.color===s.color})}else if(this.koRule==="natural-situational-superko"){a=u(function(t){return!t.pass&&t.color===s.color})}else{throw new Error("Unimplemented ko rule "+this.koRule)}}return a},_wouldBeSuicide:function t(e,r,n){var i=n.nextColor();var a=n.intersectionAt(e,r);var o=a.isEmpty()&&n.neighborsFor(a.y,a.x).filter(function(t){return t.isEmpty()}).length===0;if(!o){return false}var s=n.neighborsFor(a.y,a.x).some(function(t){var e=n.inAtari(t.y,t.x);var r=t.isOccupiedWith(i);return r&&!e});if(s){return false}var u=n.neighborsFor(a.y,a.x).some(function(t){var e=n.inAtari(t.y,t.x);var r=!t.isOccupiedWith(i);return r&&e});if(u){return false}return true}};r.default=i},{}],12:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=t("./utils");var i=d(n);var a=t("./intersection");var o=d(a);var s=t("./region");var u=d(s);var l=t("./eye-point");var f=d(l);function d(t){return t&&t.__esModule?t:{default:t}}var c=function t(e){return e.currentState()._withoutIntersectionsMatching(function(t){return e._isDeadAt(t.y,t.x)})};var h=function t(e){var r=u.default.allFor(e);var n=r.filter(function(t){return t.isNeutral()});if(r.length===0||n.length===0){return e}var i={};n.forEach(function(t){var e=null;var r=null;t.intersections.forEach(function(t){e=e||t.x;e=e||t.y;var n=Math.abs(t.y-r)+Math.abs(t.x-e);var a=["black","white"][n%2];var s=new o.default(t.y,t.x,a);i[t.y]=i[t.y]||[];i[t.y][t.x]=s})});var a=e.intersections.map(function(t){if(i[t.y]&&i[t.y][t.x]){return i[t.y][t.x]}else{return t}});return e._withNewPoints(a)};var v=function t(e){var r=u.default.allFor(e).filter(function(t){return t.isTerritory()});var n=i.default.flatMap(r,function(t){return t.intersections}).filter(function(t){return new f.default(e,t).isFalse()});var a=n.filter(function(t){return e.neighborsFor(t.y,t.x).some(function(t){return e.inAtari(t.y,t.x)})});var s=e;var l=function t(){var e=s.intersections.map(function(t){if(a.indexOf(t)>-1){return new o.default(t.y,t.x,new f.default(s,t).filledColor())}else{return t}});s=s._withNewPoints(e);var r=h(s);var n=u.default.allFor(r).filter(function(t){return t.isTerritory()});var l=i.default.flatMap(n,function(t){return t.intersections}).filter(function(t){return new f.default(r,t).isFalse()});a=l.filter(function(t){return s.neighborsFor(t.y,t.x).some(function(t){return s.inAtari(t.y,t.x)})})};while(a.length>0){l()}return s};var p=Object.freeze({score:function t(e){var r=e.deadStones().filter(function(t){return e.intersectionAt(t.y,t.x).isBlack()});var n=e.deadStones().filter(function(t){return e.intersectionAt(t.y,t.x).isWhite()});var i=e.territory();var a=e.currentState();return{black:i.black.length+a.whiteStonesCaptured+n.length,white:i.white.length+a.blackStonesCaptured+r.length}},territory:function t(e){var r=c(e);var n=h(r);var a=v(n);var o=u.default.allFor(a).filter(function(t){return t.isTerritory()});var s=o.filter(function(t){var e=u.default.merge(o,t);var r=e.map(function(t){return Math.ceil(t.numberOfEyes())});return r.length>0&&r.reduce(function(t,e){return t+e})>=2});var l=s.filter(function(t){return t.isBlack()});var f=s.filter(function(t){return t.isWhite()});return{black:i.default.flatMap(l,function(t){return t.intersections}).map(function(t){return{y:t.y,x:t.x}}),white:i.default.flatMap(f,function(t){return t.intersections}).map(function(t){return{y:t.y,x:t.x}})}}});var m=Object.freeze({score:function t(e){var r=e.intersections().filter(function(t){return t.isBlack()&&!e._isDeadAt(t.y,t.x)});var n=e.intersections().filter(function(t){return t.isWhite()&&!e._isDeadAt(t.y,t.x)});var i=e.territory();return{black:i.black.length+r.length,white:i.white.length+n.length}},territory:function t(e){var r=u.default.allFor(c(e));var n=r.filter(function(t){return t.isTerritory()});var a=n.filter(function(t){return t.isBlack()});var o=n.filter(function(t){return t.isWhite()});return{black:i.default.flatMap(a,function(t){return t.intersections}).map(function(t){return{y:t.y,x:t.x}}),white:i.default.flatMap(o,function(t){return t.intersections}).map(function(t){return{y:t.y,x:t.x}})}}});var y=function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},r=e.scoreBy,n=e.komi;this._strategy={area:m,territory:p,equivalence:m}[r];this._komi=n;if(!this._strategy){throw new Error("Unknown scoring type: "+r)}if(this._komi===null||typeof this._komi==="undefined"){throw new Error("Error initializing scorer without a komi value")}if(typeof this._komi!=="number"){throw new Error("Komi value given is not a number: "+n)}this._usePassStones=r==="equivalence";Object.freeze(this)};y.prototype={score:function t(e){var r=this._strategy.score(e);r.white+=this._komi;if(this._usePassStones){var n=e.currentState().color!=="white";return{black:r.black+e.currentState().whitePassStones+(n?1:0),white:r.white+e.currentState().blackPassStones}}else{return r}},territory:function t(e){return this._strategy.territory(e)},usingPassStones:function t(){return this._usePassStones}};r.default=y},{"./eye-point":5,"./intersection":7,"./region":9,"./utils":14}],13:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=t("./utils");var i=s(n);var a=t("./renderer");var o=s(a);function s(t){return t&&t.__esModule?t:{default:t}}var u=function t(e,r){var n=r.hooks,a=r.options;o.default.call(this,e,{hooks:n,options:a});i.default.addClass(e,"tenuki-svg-renderer")};u.prototype=Object.create(o.default.prototype);u.prototype.constructor=u;var l={};var f=function t(e,r,n){var a=n.hasCoordinates,s=n.smallerStones,u=n.flatStones;var f=[r.boardSize,a,s,u].toString();var d=i.default.createSVGElement("svg");var c=i.default.createSVGElement("defs");i.default.appendElement(d,c);var h=i.default.createSVGElement("radialGradient",{attributes:{id:e.blackGradientID,cy:"15%",r:"50%"}});i.default.appendElement(h,i.default.createSVGElement("stop",{attributes:{offset:"0%","stop-color":"hsl(0, 0%, 38%)"}}));i.default.appendElement(h,i.default.createSVGElement("stop",{attributes:{offset:"100%","stop-color":"#39363D"}}));i.default.appendElement(c,h);var v=i.default.createSVGElement("radialGradient",{attributes:{id:e.whiteGradientID,cy:"15%",r:"50%"}});i.default.appendElement(v,i.default.createSVGElement("stop",{attributes:{offset:"0%","stop-color":"#FFFFFF"}}));i.default.appendElement(v,i.default.createSVGElement("stop",{attributes:{offset:"100%","stop-color":"#fafdfc"}}));i.default.appendElement(c,v);var p=i.default.createSVGElement("g",{attributes:{class:"contents",transform:"translate("+e.MARGIN+", "+e.MARGIN+")"}});i.default.appendElement(d,p);var m=void 0;if(l[f]){m=i.default.clone(l[f])}else{m=i.default.createSVGElement("g",{attributes:{class:"lines"}});for(var y=0;y<r.boardSize-1;y++){for(var b=0;b<r.boardSize-1;b++){var S=i.default.createSVGElement("rect",{attributes:{y:y*(e.INTERSECTION_GAP_SIZE+1)-.5,x:b*(e.INTERSECTION_GAP_SIZE+1)-.5,width:e.INTERSECTION_GAP_SIZE+1,height:e.INTERSECTION_GAP_SIZE+1,class:"line-box"}});i.default.appendElement(m,S)}}l[f]=m}i.default.appendElement(p,m);var E=i.default.createSVGElement("g",{attributes:{class:"hoshi"}});i.default.appendElement(p,E);o.default.hoshiPositionsFor(r.boardSize).forEach(function(t){var r=i.default.createSVGElement("circle",{attributes:{class:"hoshi",cy:t.top*(e.INTERSECTION_GAP_SIZE+1)-.5,cx:t.left*(e.INTERSECTION_GAP_SIZE+1)-.5,r:2}});i.default.appendElement(E,r)});if(a){(function(){var t=i.default.createSVGElement("g",{attributes:{class:"coordinates",transform:"translate("+e.MARGIN+", "+e.MARGIN+")"}});var n=function n(a){[16/2+1-(16+16/2+16/(2*2)+16/(2*2*2)),16/2+1+(16+16/2)+(r.boardSize-1)*(e.INTERSECTION_GAP_SIZE+1)].forEach(function(n){i.default.appendElement(t,i.default.createSVGElement("text",{text:r.xCoordinateFor(a),attributes:{"text-anchor":"middle",y:n-.5,x:a*(e.INTERSECTION_GAP_SIZE+1)-.5}}))});[-1*(16+16/2+16/(2*2)),16+16/2+16/(2*2)+(r.boardSize-1)*(e.INTERSECTION_GAP_SIZE+1)].forEach(function(n){i.default.appendElement(t,i.default.createSVGElement("text",{text:r.yCoordinateFor(a),attributes:{"text-anchor":"middle",y:a*(e.INTERSECTION_GAP_SIZE+1)-.5+16/(2*2),x:n-.5}}))});i.default.appendElement(d,t)};for(var a=0;a<r.boardSize;a++){n(a)}})()}var g=i.default.createSVGElement("g",{attributes:{class:"intersections"}});for(var _=0;_<r.boardSize;_++){for(var w=0;w<r.boardSize;w++){var A=i.default.createSVGElement("g",{attributes:{class:"intersection"}});A.setAttribute("data-intersection-y",_);A.setAttribute("data-intersection-x",w);i.default.appendElement(g,A);var I=i.default.createSVGElement("g",{attributes:{class:"intersection-inner-container"}});i.default.appendElement(A,I);var C=i.default.createSVGElement("rect",{attributes:{y:_*(e.INTERSECTION_GAP_SIZE+1)-e.INTERSECTION_GAP_SIZE/2-.5,x:w*(e.INTERSECTION_GAP_SIZE+1)-e.INTERSECTION_GAP_SIZE/2-.5,width:e.INTERSECTION_GAP_SIZE,height:e.INTERSECTION_GAP_SIZE}});i.default.appendElement(I,C);var P=e.INTERSECTION_GAP_SIZE/2;if(s){P-=1}var x={class:"stone",cy:_*(e.INTERSECTION_GAP_SIZE+1)-.5,cx:w*(e.INTERSECTION_GAP_SIZE+1)-.5,r:P};if(!u){i.default.appendElement(I,i.default.createSVGElement("circle",{attributes:{class:"stone-shadow",cy:x["cy"]+2,cx:x["cx"],r:P}}))}var k=i.default.createSVGElement("circle",{attributes:x});i.default.appendElement(I,k);i.default.appendElement(I,i.default.createSVGElement("circle",{attributes:{class:"marker",cy:_*(e.INTERSECTION_GAP_SIZE+1)-.5,cx:w*(e.INTERSECTION_GAP_SIZE+1)-.5,r:4.5}}));i.default.appendElement(I,i.default.createSVGElement("rect",{attributes:{class:"ko-marker",y:_*(e.INTERSECTION_GAP_SIZE+1)-6-.5,x:w*(e.INTERSECTION_GAP_SIZE+1)-6-.5,width:12,height:12}}));i.default.appendElement(I,i.default.createSVGElement("rect",{attributes:{class:"territory-marker",y:_*(e.INTERSECTION_GAP_SIZE+1)-6,x:w*(e.INTERSECTION_GAP_SIZE+1)-6,width:11,height:11}}));e.grid[_]=e.grid[_]||[];e.grid[_][w]=A;e.addIntersectionEventListeners(A,_,w)}}i.default.appendElement(p,g);return d};u.prototype.generateBoard=function(t,e){var r=e.hasCoordinates,n=e.smallerStones,a=e.flatStones;this.blackGradientID=i.default.randomID("black-gradient");this.whiteGradientID=i.default.randomID("white-gradient");var o=f(this,t,{hasCoordinates:r,smallerStones:n,flatStones:a});this.svgElement=o;this.svgElement.setAttribute("height",this.BOARD_LENGTH);this.svgElement.setAttribute("width",this.BOARD_LENGTH);return o};u.prototype.computeSizing=function(){var t=this;o.default.prototype.computeSizing.call(this);this.svgElement.style.transform="none";window.requestAnimationFrame(function(){t.svgElement.style.transform=""})};u.prototype.setIntersectionClasses=function(t,e,r){if(t.getAttribute("class")!==r.join(" ")){t.setAttribute("class",r.join(" "))}if(!this.flatStones){if(e.isEmpty()){t.querySelector(".stone").setAttribute("style","")}else{t.querySelector(".stone").setAttribute("style","fill: url("+window.location+"#"+this[e.value+"GradientID"]+")")}}};r.default=u},{"./renderer":10,"./utils":14}],14:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.default={flatten:function t(e){return e.reduce(function(t,e){return t.concat(e)})},flatMap:function t(e,r){return Array.prototype.concat.apply([],e.map(r))},cartesianProduct:function t(e,r){return this.flatten(e.map(function(t){return r.map(function(e){return[t,e]})}))},randomID:function t(e){var r=[0,1,2,3].map(function(){return Math.floor(Math.random()*65536).toString(16).substring(1)}).join("");return e+"-"+r},clone:function t(e){return e.cloneNode(true)},createElement:function t(e,r){var n=document.createElement(e);if(typeof r!=="undefined"){if(r.class){n.className=r.class}}return n},createSVGElement:function t(e,r){var n=this;var i="http://www.w3.org/2000/svg";var a=document.createElementNS(i,e);if(typeof r!=="undefined"){if(r.class){r.class.split(" ").forEach(function(t){n.addClass(a,t)})}if(r.attributes){Object.keys(r.attributes).forEach(function(t){a.setAttribute(t,r.attributes[t])})}if(r.text){a.textContent=r.text.toString()}}return a},appendElement:function t(e,r){e.insertBefore(r,null)},addEventListener:function t(e,r,n){e.addEventListener(r,n,false)},removeClass:function t(e,r){if(!this.hasClass(e,r)){return}if(e.classList&&e.classList.remove){e.classList.remove(r);return}var n=RegExp("\\b"+r+"\\b","g");if(e instanceof SVGElement){e.setAttribute("class",e.getAttribute("class").replace(n,""))}else{e.className=e.getAttribute("class").replace(n,"")}},addClass:function t(e,r){if(e.classList&&e.classList.add){e.classList.add(r);return}if(e instanceof SVGElement){e.setAttribute("class",e.getAttribute("class")+" "+r)}else{e.className=e.getAttribute("class")+" "+r}},hasClass:function t(e,r){if(e.classList&&e.classList.contains){return e.classList.contains(r)}var n=RegExp("\\b"+r+"\\b","g");if(e instanceof SVGElement){return n.test(e.getAttribute("class"))}else{return n.test(e.className)}},toggleClass:function t(e,r){if(e.classList&&e.classList.toggle){e.classList.toggle(r);return}if(this.hasClass(e,r)){this.removeClass(e,r)}else{this.addClass(e,r)}},unique:function t(e){var t=[];e.forEach(function(e){if(t.indexOf(e)<0){t.push(e)}});return t}}},{}],15:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n={};function i(t,e,r,i){n[t]=n[t]||{};n[t][e]=n[t][e]||{};n[t][e][r]=n[t][e][r]||{};if(n[t][e][r][i]){return n[t][e][r][i]}var a=Math.floor(Math.random()*(Math.pow(2,31)-1));n[t][e][r][i]=a;return a}r.default={hash:function t(e,r){var n=0;r.forEach(function(t){if(!t.isEmpty()){var r=i(e,t.y,t.x,t.value);n=n^r}});return n}}},{}]},{},[1])(1)});
